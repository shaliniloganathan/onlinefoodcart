<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">

</head>
<link rel="stylesheet" href="./style.css">
<link
rel="stylesheet"
href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css"
/>
<body>
  <div class="container">
    <header>
      <nav>
        <div class="logo">
          <h1>ShppingCart</h1>
          <a href="./registration.html">Register</a>
          <a href="./login.html">login</a>
          <a href="#" >wishlist</a><a id="wishlist">&#9825;</a>
        </div>
        <div class="cart__counter">
          <i class="fa fa-shopping-cart"></i><span id="total__counter">0</span>
        </div>
      </nav>
      <div class="cart">
          <div class="cart__items">
              <div class="check_out"><h4>Total Ammount : $</h4><h4 class="total__cost">0</h4><button class="btn check_out_btn">Checkout</button> </div>
          </div>
      </div>
      
    </header>
    <!-- <div class="container">
        <div class="menu-bar">
            <nav>
                
                    <a href="./registration.html">Register</a>
                    <a href="./login.html">login</a>
                    <a href="#" >wishlist</a><a id="wishlist">&#9825;</a>
             
                 
              
                 
            </nav>
            <hr>
            
        </div> -->
        
        <!-- <span id="searchbar">
        <h1 id="heading">ElectroCart</h1>
        <span id="input">
        <input type="text" id="inputsearch" placeholder="search"><button id="searchBtn">search</button></span>
    </span>
</div>
<hr> -->

<div class="accessories">
    <ul>
        <li><a href="#">Computers</a></li>
        <li><a href="#">Electronics</a></li>
        <li><a href="#">Apparel</a></li>
        <li><a href="#">Books</a></li>
    </ul>
</div>

    

    </div>

<br><br><br>
<div class="slideshow-container">

<div class="mySlides fade">
  <div class="numbertext">1 / 2</div>
  <img src="../../assets/images/img1.jpg" style="width:100%">
  <div class="text">iphone 14 pro</div>
</div>

<div class="mySlides fade">
  <div class="numbertext">2 / 2</div>
  <img src="../../assets/images/img2.jpg" style="width:100%">
  <div class="text">Samsung zflip</div>
</div>



</div>
<br>

<div style="text-align:center">
  <span class="dot"></span> 
  <span class="dot"></span> 
  
</div>
<br>
<br>
<h1 class="heading2">Welcome to our store</h1>
<hr>
<p id="para1">Lorem ipsum dolor sit amet consectetur adipisicing elit. Accusamus amet laborum perferendis recusandae eligendi reiciendis.</p>



<div class="collection">
  <div>
  <h2 class="headercollection">Electronics</h2>
  <img src="../../assets/images/img3.jpeg">
</div>
<div>
  <h2 class="headercollection">Apparel</h2>
  <img src="../../assets/images/img4.jpeg">
  
</div>
<div class="headercollection">
  <h2>Digital downloads</h2>
  <img src="../../assets/images/img5.jpeg">

</div>
</div>

<br><br><br>

<h1 class="headerfeatured">Featured Product</h1>
<hr>

<!-- <div class="featuredproduct"> -->
<!--  
  <div class="featureimg">
   
    <img id="featureimg1" src="../../assets/images/img6.jpeg">
    <h4>Build your own computer</h4>
    <br>
    
    &#8377; <p class="price">28999</p>
    <!-- <input id="demoInput" type=number min=0 max="">&#128722;
<button onclick="increment()">+</button>
<button onclick="decrement()">-</button>
    <button class="featureadd1" id="dataproduct1">Add to cart</button><a class="cart1"> </a><button class="featurewishlist">	&#9825</button><p id="rel">
       -->
    <!-- </p>
  </div>
  </a>       
  <div class="featureimg" id="featureimg">
   
    <img src="../../assets/images/img7.jpeg">
    <h4>Apple mac book pro</h4>
    <br>
    
    <p class="price">28999</p>
    &#8377; 
    <button class="featureadd1" id="dataproduct3" onclick="handleclick()">Add to cart</button><button class="addit">+</button><button class="featureminus2">-</button><a class="cart2">&#128722; </a><button class="featurewishlist">	&#9825</button>
  </div>
  <div class="featureimg">
    <img src="../../assets/images/img8.jpeg">
    <h4>HTC ms android lolipop</h4>
    <br>
    
    <p class="price">28999</p>
    &#8377; 
    <button class="featureadd1"id="dataproduct3" onclick="handleclick()">Add to cart</button><a class="cart3">&#128722; </a><button class="featurewishlist">	&#9825</button>
  </div>
  <div class="featureimg">
    <img src="../../assets/images/img9.jpeg">
    <h4>Virtual gift card</h4>
    <br>
   
    <p class="price">28999</p>
    &#8377;
    <button class="featureadd1" onclick="handleclick()" id="dataproduct4">Add to cart</button><a class="cart4">&#128722; </a><button class="featurewishlist">	&#9825</button>
  </div>
</div>  
<div id="cart-wrap">
  <div id="cart-products">

  </div>
  <div id="cart-items"></div>
</div>  --> -->



 


<div class="products">
  <div class="product__element">
    <input type="hidden" name="" id="product__id" value="1" />
    <img src="../../assets/images/img6.jpeg" alt="" srcset="" id="image" />
    <h4 class="product__name">Nike Color</h4>
    <h5 class="product__price">$90</h5>
    <div class="btn__add__to__cart">Add To Cart</div>
  </div>
  <div class="product__element">
    <input type="hidden" name="" id="product__id" value="2" />
    <img src="../../assets/images/img7.jpeg" alt="" srcset="" id="image" />
    <h4 class="product__name">Nike Pener</h4>
    <h5 class="product__price">$80</h5>
    <div class="btn__add__to__cart">Add To Cart</div>
  </div>
  <div class="product__element">
    <input type="hidden" name="" id="product__id" value="3" />
    <img src="../../assets/images/img8.jpeg" alt="" srcset="" id="image" />
    <h4 class="product__name">Nike Somar</h4>
    <h5 class="product__price">$85</h5>
    <div class="btn__add__to__cart">Add To Cart</div>
  </div>
</div>
</div>
<script >
const cartDOM = document.querySelector(".cart__items");
const addToCartBtn = document.querySelectorAll(".btn__add__to__cart");
const cartCounter = document.querySelector(".cart__counter");
const totalCost = document.querySelector(".total__cost");
const totalCount = document.querySelector("#total__counter");
const checkOutBtn = document.querySelector(".check_out_btn");

// assign all values from local stoarge
let cartItems = (JSON.parse(localStorage.getItem("cart_items")) || []);


document.addEventListener("DOMContentLoaded", loadData);


checkOutBtn.addEventListener("click", () =>  {
    alert("Your Order Sent Succesfully");
    clearCartItems();
})

cartCounter.addEventListener("click", () => {
    cartDOM.classList.toggle("active");
})

addToCartBtn.forEach(btn => {

    btn.addEventListener("click", () => {
        let parentElement = btn.parentElement;

        const product = {
            id: parentElement.querySelector("#product__id").value,
            name: parentElement.querySelector(".product__name").innerText,
            image: parentElement.querySelector("#image").getAttribute("src"),
            price: parentElement.querySelector(".product__price").innerText.replace("$", ""),
            quantity: 1
        }

        let isIncart = cartItems.filter(item => item.id === product.id).length > 2;

        // check if alreday Exists
        if (!isIncart) {
            addItemToTheDOM(product);
        } else {
            alert("Product Already in the Cart");
            return;
        }

        const cartDOMItems = document.querySelectorAll(".cart_item");

        cartDOMItems.forEach(individualItem => {
            if (individualItem.querySelector("#product__id").value === product.id) {
                // increrase
                increaseItem(individualItem,product);
                // decrease
                decreaseItem(individualItem,product);
                // Removing Element
                removeItem(individualItem,product);
                
            }
        })

        cartItems.push(product);
        calculateTotal();
        saveToLocalStorage();
    });

})

function loadData() {
    if(cartItems.length > 0 ){
        cartItems.forEach( product => {
            addItemToTheDOM(product);
    
            const cartDOMItems = document.querySelectorAll(".cart_item");
    
            cartDOMItems.forEach(individualItem => {
                if (individualItem.querySelector("#product__id").value === product.id) {
                    // increrase
                    increaseItem(individualItem,product);
                    // decrease
                    decreaseItem(individualItem,product);
                    // Removing Element
                    removeItem(individualItem,product);
                   
                }
            });
        });
        calculateTotal();
    }
}

function calculateTotal() {
    let total = 0;
    cartItems.forEach( item => {
        total += item.quantity * item.price;
    });
    totalCost.innerText= total;
    totalCount.innerText = cartItems.length;

}

function saveToLocalStorage(){

    localStorage.setItem("cart_items", JSON.stringify(cartItems));

}
function clearCartItems(){

    localStorage.clear();
    cartItems = [];

    document.querySelectorAll(".cart__items").forEach( item => {

        item.querySelectorAll(".cart_item").forEach( node =>{
            node.remove();
        });

    });
    cartDOM.classList.toggle("active");
    calculateTotal();
    

}

function addItemToTheDOM(product){
    // Adding the new Item to the Dom
    cartDOM.insertAdjacentHTML("afterbegin", `<div class="cart_item">
            <input type="hidden" id="product__id" value="${product.id}">
           <img id="product_image" src="${product.image}" alt="" srcset="">
           <h4 class="product__name">${product.name}</h4>
           <a class="btn__small" action="decrease">&minus;</a> <h4 class="product__quantity">${product.quantity}</h4><a class="btn__small" action="increase">&plus;</a>
          <span id="product__price">${product.price}</span>
           <a class="btn__small btn_remove" action="remove">&times;</a>
       </div>`);
}

function increaseItem(individualItem, product){

    individualItem.querySelector("[action='increase']").addEventListener('click', () => {
        // Actual Array
        cartItems.forEach(cartItem => {
            if (cartItem.id === product.id) {
                individualItem.querySelector(".product__quantity").innerText = ++cartItem.quantity;
                calculateTotal();     
                saveToLocalStorage();   
            }
        })
    });

}

function decreaseItem(individualItem,product){

    individualItem.querySelector("[action='decrease']").addEventListener('click', () => {
        // all cart items in the dom
        cartItems.forEach(cartItem => {
            // Actual Array
            if (cartItem.id === product.id) {
                if (cartItem.quantity > 1) {
                    individualItem.querySelector(".product__quantity").innerText = --cartItem.quantity;
                    calculateTotal();
                    saveToLocalStorage();
                } else {
                    // removing this element and assign the new elemntos to the old of the array
                    console.log(cartItems);

                    cartItems = cartItems.filter(newElements => newElements.id !== product.id);
                    individualItem.remove();

                    calculateTotal();
                    saveToLocalStorage();

                }

            }
        })
    });
}

function removeItem(individualItem, product){

    individualItem.querySelector("[action='remove']").addEventListener('click', () => {
        cartItems.forEach(cartItem => {
            if (cartItem.id === product.id) {
                cartItems = cartItems.filter(newElements => newElements.id !== product.id);
                individualItem.remove();
                calculateTotal();
                saveToLocalStorage();
            }
        })
    });
}

</script>

 
</script>
</body>
</html> 
